<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
  <title>èˆŒå°–ä¸Šçš„ç¾é£Ÿï¼šæ—©é¤åº—çš„è›‹é¥¼</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 16px;
      background: radial-gradient(circle at top left, #ffe7a3 0, #ffe6d2 28%, #fdf5ff 60%, #f5f7ff 100%);
      background-attachment: fixed;
      line-height: 1.6;
      color: #222;
    }
    h1, h2, h3 {
      margin: 8px 0;
    }
    .container {
      max-width: 960px;
      margin: 0 auto 40px;
    }
    .page-header {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      margin-bottom: 18px;
    }
    .page-title {
      font-size: 1.9rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .page-title span.emoji {
      font-size: 2.1rem;
    }
    .page-subtitle {
      font-size: 0.98rem;
      color: #555;
    }
    .nav-chips {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 6px;
      margin-top: 6px;
    }
    .nav-chip {
      border-radius: 999px;
      padding: 4px 12px;
      font-size: 0.8rem;
      background: rgba(255,255,255,0.8);
      border: 1px dashed rgba(255,171,64,0.6);
    }

    .card {
      background: rgba(255,255,255,0.96);
      border-radius: 20px;
      padding: 18px 18px 20px;
      margin-bottom: 18px;
      box-shadow: 0 8px 22px rgba(255,183,77,0.25);
      border: 1px solid rgba(255,224,178,0.8);
      position: relative;
      overflow: hidden;
    }
    .card::before {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background-image:
        radial-gradient(circle at top left, rgba(255,255,255,0.7) 0, transparent 55%),
        radial-gradient(circle at bottom right, rgba(255,224,178,0.35) 0, transparent 55%);
      mix-blend-mode: screen;
    }
    .card-inner {
      position: relative;
      z-index: 1;
    }

    .section-title {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 6px;
    }
    .flag {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 2px 10px;
      border-radius: 999px;
      font-size: 0.8rem;
      background: linear-gradient(90deg, #ffca7a, #ff9a7a);
      color: #5a2a00;
      font-weight: 600;
    }
    .flag span {
      font-size: 1rem;
    }
    .small-note {
      font-size: 0.8rem;
      color: #777;
    }

    .chips {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin: 8px 0 12px;
    }
    .chip-btn {
      border: 1px solid #ffd08a;
      border-radius: 999px;
      padding: 6px 14px;
      cursor: pointer;
      background: #fff9ef;
      font-size: 0.95rem;
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.1s;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }
    .chip-btn::before {
      content: "ğŸ¥š";
      font-size: 0.95rem;
    }
    .chip-btn.selected {
      background: #ffe0b2;
      border-color: #ffb74d;
      box-shadow: 0 0 0 1px rgba(255,167,38,0.35);
      transform: translateY(-1px);
    }

    .btn {
      border-radius: 999px;
      border: none;
      padding: 8px 18px;
      cursor: pointer;
      background: linear-gradient(135deg, #ff9800, #ff7043);
      color: #fff;
      font-size: 0.95rem;
      margin: 4px 4px 4px 0;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 4px 10px rgba(255,152,0,0.38);
      transition: transform 0.08s ease, box-shadow 0.08s ease, filter 0.06s;
    }
    .btn.secondary {
      background: #ffe9cf;
      color: #5d4037;
      box-shadow: none;
      border: 1px solid #ffcc80;
    }
    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      box-shadow: none;
      transform: none;
    }
    .btn:not(:disabled):active {
      transform: translateY(1px) scale(0.99);
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
      filter: brightness(0.97);
    }

    .sentence-output {
      border-radius: 12px;
      background: #fff4e0;
      padding: 10px 12px;
      min-height: 40px;
      margin-top: 8px;
      font-size: 1rem;
      border: 1px dashed #ffb74d;
    }

    .tf-item {
      border-radius: 12px;
      border: 1px solid #ffe0b2;
      padding: 10px 12px;
      margin-top: 8px;
      background: #fffaf3;
    }
    .tf-sentence {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .tf-number {
      width: 24px;
      height: 24px;
      border-radius: 999px;
      background: #ffe0b2;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 0.82rem;
      margin-right: 2px;
    }
    .tf-buttons {
      margin-top: 6px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 0.75rem;
      margin-left: 4px;
    }
    .badge.correct {
      background: #e0f7e9;
      color: #1b7a3c;
    }
    .badge.wrong {
      background: #ffe3e3;
      color: #b3261e;
    }
    .explain {
      font-size: 0.8rem;
      color: #555;
      margin-top: 4px;
    }

    .order-box {
      border-radius: 12px;
      border: 1px solid #ffe0b2;
      padding: 10px 12px;
      margin-top: 10px;
      background: #fffdf7;
    }
    .pieces {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin: 8px 0;
    }
    .piece-btn {
      border-radius: 10px;
      border: 1px solid #ffc77a;
      padding: 6px 10px;
      cursor: pointer;
      background: #fff4e0;
      font-size: 0.95rem;
      box-shadow: 0 2px 4px rgba(255,167,38,0.2);
    }
    .piece-btn.used {
      opacity: 0.4;
      cursor: default;
      box-shadow: none;
    }
    .built {
      margin-top: 4px;
      font-size: 0.92rem;
    }

    /* ç¿»ç¿»ä¹ */
    .memory-grid {
      display: grid;
      grid-template-columns: repeat(4, minmax(60px, 1fr));
      gap: 10px;
      margin: 10px 0 4px;
    }
    .memory-card {
      position: relative;
      width: 100%;
      padding-top: 130%;
      cursor: pointer;
      perspective: 800px;
    }
    .memory-inner {
      position: absolute;
      inset: 0;
      transition: transform 0.35s;
      transform-style: preserve-3d;
    }
    .memory-card.flipped .memory-inner,
    .memory-card.matched .memory-inner {
      transform: rotateY(180deg);
    }
    .memory-face {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 12px;
      border: 1px solid #ffc77a;
      backface-visibility: hidden;
    }
    .memory-front {
      background: #ffe0b2;
      font-size: 1.6rem;
      font-weight: 700;
      color: #5d4037;
    }
    .memory-back {
      background: #fffdf7;
      transform: rotateY(180deg);
      flex-direction: column;
      gap: 2px;
      font-size: 1.1rem;
    }
    .memory-back span.emoji {
      font-size: 1.4rem;
    }
    .memory-card.matched {
      cursor: default;
      opacity: 0.9;
      box-shadow: 0 3px 8px rgba(76,175,80,0.3);
    }

    /* è½¬ç›˜ */
    .wheel-wrap {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      align-items: center;
      justify-content: center;
      margin-top: 10px;
    }
    .wheel-container {
      position: relative;
      width: 220px;
      height: 220px;
    }
    .wheel {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 6px solid #ffcc80;
      background: conic-gradient(
        #fff8e1 0deg 60deg,
        #ffe0b2 60deg 120deg,
        #ffecb3 120deg 180deg,
        #ffe0b2 180deg 240deg,
        #fff8e1 240deg 300deg,
        #ffe0b2 300deg 360deg
      );
      position: relative;
      transition: transform 3s cubic-bezier(0.19, 1, 0.22, 1);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    .wheel-pointer {
      position: absolute;
      top: -14px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 10px solid transparent;
      border-right: 10px solid transparent;
      border-bottom: 18px solid #ff7043;
      filter: drop-shadow(0 2px 3px rgba(0,0,0,0.26));
      z-index: 3;
    }
    .wheel-center {
      position: absolute;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: #fffaf3;
      border: 3px solid #ffb74d;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      box-shadow: 0 3px 8px rgba(255,167,38,0.4);
      z-index: 2;
    }
    .wheel-labels {
      position: absolute;
      inset: 18px;
      pointer-events: none;
      z-index: 1;
    }
    .wheel-item {
      position: absolute;
      left: 50%;
      top: 50%;
      transform-origin: 0 0;
    }
    .wheel-item span {
      display: inline-block;
      background: rgba(255,255,255,0.9);
      padding: 2px 6px;
      border-radius: 999px;
      border: 1px solid rgba(255,183,77,0.7);
      font-size: 0.74rem;
      white-space: nowrap;
    }

    .spin-info {
      max-width: 260px;
      font-size: 0.9rem;
    }
    .result-box {
      margin-top: 6px;
      border-radius: 10px;
      background: #fff4e0;
      padding: 8px 10px;
      border: 1px dashed #ffb74d;
      font-size: 0.95rem;
    }
    .spin-list {
      margin: 4px 0 0;
      padding-left: 18px;
      font-size: 0.8rem;
      color: #555;
    }

    .footer-note {
      text-align: center;
      font-size: 0.8rem;
      color: #777;
      margin-top: 10px;
    }

    @media (max-width: 600px) {
      .card {
        padding: 14px 12px 16px;
      }
      .page-title {
        font-size: 1.5rem;
      }
      .wheel-container {
        width: 190px;
        height: 190px;
      }
    }
  </style>
</head>
<body>
<div class="container">
  <header class="page-header">
    <div class="page-title">
      <span class="emoji">ğŸ¥š</span>
      <span>èˆŒå°–ä¸Šçš„ç¾é£Ÿï¼šæ—©é¤åº—çš„è›‹é¥¼</span>
      <span class="emoji">ğŸ¥¤</span>
    </div>
    <div class="page-subtitle">è®¤ç®€ä½“å­—ã€ç»ƒå£è¯´ã€ç©æ¸¸æˆï¼šä¸€èµ·åœ¨æ—©é¤åº—ä¸Šä¸­æ–‡è¯¾ï¼</div>
    <div class="nav-chips">
      <div class="nav-chip">é…æ–™å¥å‹ç»ƒä¹ </div>
      <div class="nav-chip">åˆ¤æ–­å¥å­å¯¹ä¸å¯¹</div>
      <div class="nav-chip">ä»£å·é‡ç»„è¯­åº</div>
      <div class="nav-chip">ç¿»ç¿»ä¹è®°å•è¯</div>
      <div class="nav-chip">è½¬ç›˜è¯´å¥å­</div>
    </div>
  </header>

  <!-- å…³å¡ä¸€ -->
  <section class="card">
    <div class="card-inner">
      <div class="section-title">
        <h2><span class="flag"><span>ğŸ³</span> å…³å¡ä¸€ï¼šç‰¹åˆ¶æˆ‘çš„è›‹é¥¼</span></h2>
        <span class="small-note">è¯·é€‰æ‹©ä¸¤ç§é…æ–™ï¼Œåšå‡ºä½ çš„ã€Œè¶…çº§è›‹é¥¼ã€ï¼Œå†å¿µå‡ºæ¥ã€‚</span>
      </div>
      <p>é…æ–™è¯æ±‡ï¼š</p>
      <div class="chips" id="ingredient-chips">
        <button class="chip-btn" data-word="åŸ¹æ ¹">åŸ¹æ ¹</button>
        <button class="chip-btn" data-word="ç‰ç±³">ç‰ç±³</button>
        <button class="chip-btn" data-word="é²”é±¼">é²”é±¼</button>
      </div>

      <button class="btn secondary" id="reset-ingredients">ğŸ” é‡æ–°é€‰é…æ–™</button>
      <button class="btn" id="speak-ingredients">â–¶ æ’­æ”¾å¥å­</button>

      <div class="sentence-output" id="egg-sentence">
        æˆ‘çš„è›‹é¥¼ï¼šï¼¿ï¼¿ï¼¿ + ï¼¿ï¼¿ï¼¿ è›‹é¥¼
      </div>
      <div class="small-note">
        å°æç¤ºï¼šå­¦ç”Ÿå¯ä»¥è·Ÿç€å¿µä¸€éï¼š<strong>ã€Œæˆ‘çš„è›‹é¥¼ï¼šç‰ç±³ + åŸ¹æ ¹ è›‹é¥¼ã€</strong>
      </div>
    </div>
  </section>

  <!-- å…³å¡äºŒ -->
  <section class="card">
    <div class="card-inner">
      <div class="section-title">
        <h2><span class="flag"><span>âœ…</span> å…³å¡äºŒï¼šè¿™å¥è¯å¯¹ä¸å¯¹ï¼Ÿ</span></h2>
        <span class="small-note">åˆ¤æ–­å’Œã€Œæ—©é¤è›‹é¥¼ã€æœ‰æ²¡æœ‰å…³ç³»ã€ç”¨è¯å¯¹ä¸å¯¹ã€‚ï¼ˆé€‰é”™å¯ä»¥å†æ”¹ï¼‰</span>
      </div>

      <div id="tf-list">
        <div class="tf-item" data-answer="false">
          <div class="tf-sentence">
            <span class="tf-number">1</span>
            <span>è€æ¿ï¼Œæˆ‘ä»Šå¤©æƒ³åƒé²”é±¼åå¸ã€‚</span>
          </div>
          <div class="tf-buttons">
            <button class="btn secondary tf-btn" data-choice="true">âœ… æ­£ç¡®</button>
            <button class="btn secondary tf-btn" data-choice="false">âŒ é”™è¯¯</button>
          </div>
          <div class="feedback"></div>
        </div>

        <div class="tf-item" data-answer="true">
          <div class="tf-sentence">
            <span class="tf-number">2</span>
            <span>ç‰ç±³è›‹é¥¼æ˜¯æˆ‘çš„æ—©é¤ã€‚</span>
          </div>
          <div class="tf-buttons">
            <button class="btn secondary tf-btn" data-choice="true">âœ… æ­£ç¡®</button>
            <button class="btn secondary tf-btn" data-choice="false">âŒ é”™è¯¯</button>
          </div>
          <div class="feedback"></div>
        </div>

        <div class="tf-item" data-answer="false">
          <div class="tf-sentence">
            <span class="tf-number">3</span>
            <span>æˆ‘è¦ä¸€æ¯åŸ¹æ ¹è›‹é¥¼ã€‚</span>
          </div>
          <div class="tf-buttons">
            <button class="btn secondary tf-btn" data-choice="true">âœ… æ­£ç¡®</button>
            <button class="btn secondary tf-btn" data-choice="false">âŒ é”™è¯¯</button>
          </div>
          <div class="feedback"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- å…³å¡ä¸‰ -->
  <section class="card">
    <div class="card-inner">
      <div class="section-title">
        <h2><span class="flag"><span>ğŸ”¢</span> å…³å¡ä¸‰ï¼šç”¨ä»£å·é‡ç»„å¥å­</span></h2>
        <span class="small-note">ç‚¹ä»£å·ï¼ŒæŠŠå¥å­æ’æˆæ­£ç¡®é¡ºåºï¼Œå†å¿µä¸€æ¬¡å®Œæ•´çš„å¥å­ã€‚</span>
      </div>

      <!-- é¢˜ç›®ä¸€ -->
      <div class="order-box" data-correct="1,3,4,2">
        <h3>é¢˜ç›®ä¸€</h3>
        <div>è¯·ç”¨ä»£å·é‡æ–°ç»„åˆä¸‹åˆ—å¥å­ï¼š</div>
        <div>(1) æˆ‘ã€€(2) è›‹é¥¼ã€€(3) æ—©é¤ã€€(4) åƒ</div>

        <div class="pieces">
          <button class="piece-btn" data-id="1">1 æˆ‘</button>
          <button class="piece-btn" data-id="2">2 è›‹é¥¼</button>
          <button class="piece-btn" data-id="3">3 æ—©é¤</button>
          <button class="piece-btn" data-id="4">4 åƒ</button>
        </div>

        <div class="built">ä½ çš„ç­”æ¡ˆï¼š<span class="built-seq"></span></div>
        <div class="built">ç»„æˆçš„å¥å­ï¼š<span class="built-sentence"></span></div>
        <button class="btn secondary reset-order">ğŸ” é‡æ¥</button>
        <div class="feedback"></div>
      </div>

      <!-- é¢˜ç›®äºŒ -->
      <div class="order-box" data-correct="3,2,4,1">
        <h3>é¢˜ç›®äºŒ</h3>
        <div>è¯·ç”¨ä»£å·é‡æ–°ç»„åˆä¸‹åˆ—å¥å­ï¼š</div>
        <div>(1) åŸ¹æ ¹ã€€(2) é‡Œé¢ã€€(3) è›‹é¥¼ã€€(4) æœ‰</div>

        <div class="pieces">
          <button class="piece-btn" data-id="1">1 åŸ¹æ ¹</button>
          <button class="piece-btn" data-id="2">2 é‡Œé¢</button>
          <button class="piece-btn" data-id="3">3 è›‹é¥¼</button>
          <button class="piece-btn" data-id="4">4 æœ‰</button>
        </div>

        <div class="built">ä½ çš„ç­”æ¡ˆï¼š<span class="built-seq"></span></div>
        <div class="built">ç»„æˆçš„å¥å­ï¼š<span class="built-sentence"></span></div>
        <button class="btn secondary reset-order">ğŸ” é‡æ¥</button>
        <div class="feedback"></div>
      </div>
    </div>
  </section>

  <!-- å…³å¡å››ï¼šç¿»ç¿»ä¹ -->
  <section class="card">
    <div class="card-inner">
      <div class="section-title">
        <h2><span class="flag"><span>ğŸƒ</span> å…³å¡å››ï¼šæ—©é¤ç¿»ç¿»ä¹</span></h2>
        <span class="small-note">ç¿»ç‰Œæ‰¾å‡ºä¸€æ ·çš„ä¸¤å¼ ã€‚è¾¹ç©è¾¹å¿µï¼šç‰ç±³ã€åŸ¹æ ¹ã€é²”é±¼ã€è›‹é¥¼ã€‚</span>
      </div>
      <button class="btn secondary" id="memory-reset">ğŸ” é‡æ–°æ´—ç‰Œ</button>

      <div class="memory-grid" id="memory-grid">
        <!-- å¡ç‰‡ç”± JS ç”Ÿæˆ -->
      </div>
      <div class="small-note" id="memory-message">é…å¯¹æˆåŠŸæ—¶ï¼Œå¯ä»¥è¯·å­¦ç”Ÿä¸€èµ·å¿µå‡ºé‚£ä¸€ç§æ—©é¤é…æ–™ã€‚</div>
    </div>
  </section>

  <!-- å…³å¡äº”ï¼šè½¬ç›˜ -->
  <section class="card">
    <div class="card-inner">
      <div class="section-title">
        <h2><span class="flag"><span>ğŸ¡</span> å…³å¡äº”ï¼šæ—©é¤è½¬è½¬ä¹</span></h2>
        <span class="small-note">è½¬ä¸€è½¬ï¼Œçœ‹çœ‹ä»Šå¤©çš„æ—©é¤æ˜¯ä»€ä¹ˆï¼Œç„¶åè¯´å‡ºå®Œæ•´çš„å¥å­ã€‚</span>
      </div>

      <div class="wheel-wrap">
        <div class="wheel-container">
          <div class="wheel-pointer"></div>
          <div class="wheel" id="wheel">
            <div class="wheel-labels" id="wheel-labels"></div>
            <div class="wheel-center">ğŸ½ï¸</div>
          </div>
        </div>

        <div class="spin-info">
          <p>æŒ‰ã€Œè½¬ï¼ã€ä¹‹åï¼ŒæŒ‡é’ˆä¼šåœåœ¨ä¸€ä¸ªæ—©é¤ã€‚ä¾‹å¦‚ï¼š</p>
          <p><strong>ã€Œç‰ç±³è›‹é¥¼ã€</strong> â†’ å­¦ç”Ÿè¯´ï¼š</p>
          <p>ğŸ‘‰ <strong>ä»Šå¤©çš„æ—©é¤æ˜¯ç‰ç±³è›‹é¥¼ã€‚</strong></p>
          <button class="btn" id="spin-btn">ğŸ² è½¬ï¼</button>
          <div class="result-box" id="spin-result">
            ä»Šå¤©çš„æ—©é¤æ˜¯ï¼šï¼¿ï¼¿ï¼¿ï¼¿ã€‚
          </div>
          <ul class="spin-list">
            <li>ç‰ç±³è›‹é¥¼</li>
            <li>åŸ¹æ ¹è›‹é¥¼</li>
            <li>é²”é±¼è›‹é¥¼</li>
            <li>ä¸€ä»½è›‹é¥¼ + è±†æµ†</li>
            <li>ç‰ç±³è›‹é¥¼ + å¥¶èŒ¶</li>
            <li>é²”é±¼è›‹é¥¼ + è±†æµ†</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <div class="footer-note">
    å°å»ºè®®ï¼šå¯ä»¥è®©å­¦ç”Ÿè½®æµè½¬è½¬ç›˜ï¼Œæ¯è½¬åˆ°ä¸€ç§æ—©é¤ï¼Œå°±åŠ ä¸€åˆ†æˆ–ç”»ä¸€ä¸ªç¬‘è„¸ï¼Œå˜æˆå°å°ç«èµ›ã€‚
  </div>
</div>

<script>
  // ===== æŒ‰é”®éŸ³ï¼šæ‰€æœ‰æŒ‰é’®éƒ½æœ‰å£°éŸ³ =====
  let clickAudioCtx = null;
  function ensureAudioCtx() {
    if (clickAudioCtx) return clickAudioCtx;
    const AC = window.AudioContext || window.webkitAudioContext;
    if (!AC) return null;
    clickAudioCtx = new AC();
    return clickAudioCtx;
  }

  function playClickSound() {
    try {
      const ctx = ensureAudioCtx();
      if (!ctx) return;
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.type = 'sine';
      const now = ctx.currentTime;
      osc.frequency.value = 900;
      gain.gain.setValueAtTime(0.18, now);
      gain.gain.exponentialRampToValueAtTime(0.001, now + 0.12);
      osc.connect(gain);
      gain.connect(ctx.destination);
      osc.start(now);
      osc.stop(now + 0.12);
    } catch (e) {}
  }

  function playSpinSound(duration = 3) {
    try {
      const ctx = ensureAudioCtx();
      if (!ctx) return;
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      const now = ctx.currentTime;
      osc.type = 'triangle';
      osc.frequency.setValueAtTime(650, now);
      osc.frequency.linearRampToValueAtTime(250, now + duration);
      gain.gain.setValueAtTime(0.16, now);
      gain.gain.linearRampToValueAtTime(0.001, now + duration);
      osc.connect(gain);
      gain.connect(ctx.destination);
      osc.start(now);
      osc.stop(now + duration);
    } catch (e) {}
  }

  document.addEventListener('DOMContentLoaded', () => {
    const allButtons = Array.from(document.querySelectorAll('button'));
    allButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        playClickSound();
      }, { capture: true });
    });
  });

  // ===== å…³å¡ä¸€ï¼šç‰¹åˆ¶æˆ‘çš„è›‹é¥¼ =====
  const ingredientButtons = Array.from(document.querySelectorAll('#ingredient-chips .chip-btn'));
  const eggSentence = document.getElementById('egg-sentence');
  const resetIngredientsBtn = document.getElementById('reset-ingredients');
  const speakBtn = document.getElementById('speak-ingredients');

  function updateEggSentence() {
    const selected = ingredientButtons.filter(btn => btn.classList.contains('selected'))
                                      .map(btn => btn.dataset.word);
    if (selected.length === 2) {
      eggSentence.textContent = `æˆ‘çš„è›‹é¥¼ï¼š${selected[0]} + ${selected[1]} è›‹é¥¼`;
    } else if (selected.length === 1) {
      eggSentence.textContent = `æˆ‘çš„è›‹é¥¼ï¼š${selected[0]} + ï¼¿ï¼¿ï¼¿ è›‹é¥¼`;
    } else {
      eggSentence.textContent = 'æˆ‘çš„è›‹é¥¼ï¼šï¼¿ï¼¿ï¼¿ + ï¼¿ï¼¿ï¼¿ è›‹é¥¼';
    }
  }

  ingredientButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      const selectedCount = ingredientButtons.filter(b => b.classList.contains('selected')).length;
      if (btn.classList.contains('selected')) {
        btn.classList.remove('selected');
      } else {
        if (selectedCount >= 2) {
          const firstSelected = ingredientButtons.find(b => b.classList.contains('selected'));
          if (firstSelected) firstSelected.classList.remove('selected');
        }
        btn.classList.add('selected');
      }
      updateEggSentence();
    });
  });

  resetIngredientsBtn.addEventListener('click', () => {
    ingredientButtons.forEach(btn => btn.classList.remove('selected'));
    updateEggSentence();
  });

  speakBtn.addEventListener('click', () => {
    if (!('speechSynthesis' in window)) {
      alert('è¿™ä¸ªæµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³æ’­æ”¾ï¼Œå¯ä»¥æ”¹ç”¨è€å¸ˆç¤ºèŒƒå¿µç»™å­¦ç”Ÿå¬ã€‚');
      return;
    }
    const text = eggSentence.textContent.replace(/ï¼¿/g, 'ç©º');
    if (!text || text.includes('ï¼¿ï¼¿ï¼¿')) {
      alert('å…ˆé€‰å¥½ä¸¤ç§é…æ–™ï¼Œå†å¬å¥å­ï½');
      return;
    }
    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = 'zh-CN';
    window.speechSynthesis.cancel();
    window.speechSynthesis.speak(utter);
  });

  // ===== å…³å¡äºŒï¼šæ­£è¯¯åˆ¤æ–­ï¼ˆå¯é‡é€‰ï¼‰ =====
  const tfItems = Array.from(document.querySelectorAll('.tf-item'));

  tfItems.forEach(item => {
    const answer = item.dataset.answer === 'true';
    const buttons = item.querySelectorAll('.tf-btn');
    const feedbackDiv = item.querySelector('.feedback');

    buttons.forEach(btn => {
      btn.addEventListener('click', () => {
        const choice = btn.dataset.choice === 'true';

        const badge = document.createElement('span');
        const explain = document.createElement('div');
        explain.className = 'explain';

        if (choice === answer) {
          badge.className = 'badge correct';
          badge.textContent = 'ç­”å¯¹äº†ï¼';
        } else {
          badge.className = 'badge wrong';
          badge.textContent = 'å†æƒ³æƒ³ï½';
        }

        const text = item.textContent;
        if (text.includes('é²”é±¼åå¸')) {
          explain.textContent = 'è¿™å¥è¯è¯´æƒ³åƒçš„æ˜¯ã€Œåå¸ã€ï¼Œä¸æ˜¯è›‹é¥¼ã€‚';
        } else if (text.includes('ç‰ç±³è›‹é¥¼æ˜¯æˆ‘çš„æ—©é¤')) {
          explain.textContent = 'è¿™å¥è¯åˆç†ï¼šæ—©é¤åƒç‰ç±³è›‹é¥¼ã€‚';
        } else if (text.includes('ä¸€æ¯åŸ¹æ ¹è›‹é¥¼')) {
          explain.textContent = 'ã€Œè›‹é¥¼ã€åº”è¯¥ç”¨ã€Œä¸€ä»½ã€ï¼Œä¸æ˜¯ã€Œä¸€æ¯ã€ã€‚';
        }

        feedbackDiv.innerHTML = '';
        feedbackDiv.appendChild(badge);
        feedbackDiv.appendChild(explain);
      });
    });
  });

  // ===== å…³å¡ä¸‰ï¼šä»£å·é‡ç»„ =====
  const orderBoxes = Array.from(document.querySelectorAll('.order-box'));

  orderBoxes.forEach(box => {
    const correctSeq = box.dataset.correct.split(',').map(Number);
    const pieceButtons = Array.from(box.querySelectorAll('.piece-btn'));
    const seqSpan = box.querySelector('.built-seq');
    const sentenceSpan = box.querySelector('.built-sentence');
    const feedbackDiv = box.querySelector('.feedback');
    const resetBtn = box.querySelector('.reset-order');

    let currentSeq = [];

    function render() {
      seqSpan.textContent = currentSeq.join(' - ');

      const idToText = {};
      pieceButtons.forEach(btn => {
        const id = Number(btn.dataset.id);
        const text = btn.textContent.replace(/^\d+\s*/, '');
        idToText[id] = text;
      });
      const words = currentSeq.map(id => idToText[id] || '');
      sentenceSpan.textContent = words.join(' ');

      if (currentSeq.length === correctSeq.length) {
        const isCorrect = currentSeq.every((v, i) => v === correctSeq[i]);
        const badge = document.createElement('span');
        badge.className = 'badge ' + (isCorrect ? 'correct' : 'wrong');
        badge.textContent = isCorrect ? 'é¡ºåºæ­£ç¡®ï¼' : 'é¡ºåºä¸å¤ªå¯¹ï½å†è¯•ä¸€æ¬¡ã€‚';
        feedbackDiv.innerHTML = '';
        feedbackDiv.appendChild(badge);
        pieceButtons.forEach(btn => btn.disabled = true);
      }
    }

    pieceButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        if (btn.classList.contains('used')) return;
        if (currentSeq.length >= correctSeq.length) return;

        const id = Number(btn.dataset.id);
        currentSeq.push(id);
        btn.classList.add('used');
        render();
      });
    });

    resetBtn.addEventListener('click', () => {
      currentSeq = [];
      pieceButtons.forEach(btn => {
        btn.classList.remove('used');
        btn.disabled = false;
      });
      feedbackDiv.innerHTML = '';
      render();
    });

    render();
  });

  // ===== å…³å¡å››ï¼šç¿»ç¿»ä¹ =====
  const memoryGrid = document.getElementById('memory-grid');
  const memoryResetBtn = document.getElementById('memory-reset');
  const memoryMessage = document.getElementById('memory-message');

  const memoryItems = [
    { key: 'ç‰ç±³', emoji: 'ğŸŒ½' },
    { key: 'åŸ¹æ ¹', emoji: 'ğŸ¥“' },
    { key: 'é²”é±¼', emoji: 'ğŸŸ' },
    { key: 'è›‹é¥¼', emoji: 'ğŸ¥š' }
  ];

  let memoryLock = false;
  let memoryFlipped = [];
  let matchedCount = 0;

  function createMemoryCards() {
    memoryGrid.innerHTML = '';
    memoryLock = false;
    memoryFlipped = [];
    matchedCount = 0;
    memoryMessage.textContent = 'é…å¯¹æˆåŠŸæ—¶ï¼Œå¯ä»¥è¯·å­¦ç”Ÿä¸€èµ·å¿µå‡ºé‚£ä¸€ç§æ—©é¤é…æ–™ã€‚';

    const deck = [];
    memoryItems.forEach(item => {
      deck.push({ ...item });
      deck.push({ ...item });
    });

    for (let i = deck.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [deck[i], deck[j]] = [deck[j], deck[i]];
    }

    deck.forEach((cardData, index) => {
      const card = document.createElement('div');
      card.className = 'memory-card';
      card.dataset.key = cardData.key;
      card.dataset.index = index.toString();

      const inner = document.createElement('div');
      inner.className = 'memory-inner';

      const front = document.createElement('div');
      front.className = 'memory-face memory-front';
      front.textContent = 'ï¼Ÿ';

      const back = document.createElement('div');
      back.className = 'memory-face memory-back';
      const emo = document.createElement('span');
      emo.className = 'emoji';
      emo.textContent = cardData.emoji;
      const word = document.createElement('span');
      word.textContent = cardData.key;
      back.appendChild(emo);
      back.appendChild(word);

      inner.appendChild(front);
      inner.appendChild(back);
      card.appendChild(inner);

      card.addEventListener('click', () => handleMemoryClick(card));
      memoryGrid.appendChild(card);
    });
  }

  function handleMemoryClick(card) {
    if (memoryLock) return;
    if (card.classList.contains('flipped') || card.classList.contains('matched')) return;

    card.classList.add('flipped');
    memoryFlipped.push(card);

    if (memoryFlipped.length === 2) {
      memoryLock = true;
      const [c1, c2] = memoryFlipped;
      if (c1.dataset.key === c2.dataset.key) {
        setTimeout(() => {
          c1.classList.add('matched');
          c2.classList.add('matched');
          memoryFlipped = [];
          memoryLock = false;
          matchedCount++;
          memoryMessage.textContent = `å¤ªæ£’äº†ï¼ä½ é…å¯¹æˆåŠŸï¼š${c1.dataset.key}ã€‚`;
          if (matchedCount === memoryItems.length) {
            memoryMessage.textContent = 'å…¨éƒ¨é…å¯¹å®Œæˆï¼æ—©é¤ OKï¼Œå¯ä»¥å¼€åŠ¨ï¼Œè¯·å¤§å®¶ä¸€èµ·å¿µä¸€éæ‰€æœ‰é…æ–™ã€‚';
          }
        }, 450);
      } else {
        setTimeout(() => {
          c1.classList.remove('flipped');
          c2.classList.remove('flipped');
          memoryFlipped = [];
          memoryLock = false;
        }, 650);
      }
    }
  }

  memoryResetBtn.addEventListener('click', createMemoryCards);
  createMemoryCards();

  // ===== å…³å¡äº”ï¼šè½¬ç›˜ï¼ˆæœ‰æ–‡å­—ï¼‹è½¬åŠ¨æœ‰å£°éŸ³ï¼‰ =====
  const wheel = document.getElementById('wheel');
  const wheelLabels = document.getElementById('wheel-labels');
  const spinBtn = document.getElementById('spin-btn');
  const spinResult = document.getElementById('spin-result');

  const wheelOptions = [
    'ç‰ç±³è›‹é¥¼',
    'åŸ¹æ ¹è›‹é¥¼',
    'é²”é±¼è›‹é¥¼',
    'ä¸€ä»½è›‹é¥¼ + è±†æµ†',
    'ç‰ç±³è›‹é¥¼ + å¥¶èŒ¶',
    'é²”é±¼è›‹é¥¼ + è±†æµ†'
  ];

  function setupWheelLabels() {
    wheelLabels.innerHTML = '';
    const count = wheelOptions.length;
    const baseAngle = 360 / count;
    const radius = 70; // æ–‡å­—ç¦»ä¸­å¿ƒçš„è·ç¦»

    wheelOptions.forEach((text, index) => {
      const angle = baseAngle * index + baseAngle / 2;

      const item = document.createElement('div');
      item.className = 'wheel-item';
      item.style.transform = `rotate(${angle}deg) translate(${radius}px)`;

      const span = document.createElement('span');
      span.textContent = text;
      span.style.transform = `rotate(${-angle}deg)`;

      item.appendChild(span);
      wheelLabels.appendChild(item);
    });
  }
  setupWheelLabels();

  let currentRotation = 0;
  spinBtn.addEventListener('click', () => {
    const count = wheelOptions.length;
    const baseAngle = 360 / count;
    const extraTurns = 4 + Math.floor(Math.random() * 3); // 4~6åœˆ
    const chosenIndex = Math.floor(Math.random() * count);
    const targetAngle = 360 - (chosenIndex * baseAngle + baseAngle / 2);
    const newRotation = extraTurns * 360 + targetAngle;

    currentRotation += newRotation;
    wheel.style.transform = `rotate(${currentRotation}deg)`;
    spinBtn.disabled = true;

    // è½¬åŠ¨æ—¶å‘å‡ºâ€œå‘¼å‘¼â€å£°
    playSpinSound(3);

    setTimeout(() => {
      const breakfast = wheelOptions[chosenIndex];
      spinResult.textContent = `ä»Šå¤©çš„æ—©é¤æ˜¯ï¼š${breakfast}ã€‚`;
      spinBtn.disabled = false;
    }, 3000);
  });
</script>
</body>
</html>
